<html>
  <head>
    <title>3D</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />
    <link type="text/css" rel="stylesheet" href="main.css" />
    <style>
      a {
        color: #8ff;
      }

      #menu {
        position: absolute;
        bottom: 20px;
        width: 100%;
        text-align: center;
      }

      .element {
        width: 140px;
        height: 180px;
        box-shadow: 0px 0px 12px #034aa6;
        cursor: default;
        border-radius: 10px;
      }

      .element:hover {
        box-shadow: 0px 0px 20px 7px #034aa6;
      }

      button {
        color: rgba(127, 255, 255, 0.75);
        background: #010d26;
        border-radius: 5px;
        padding: 5px 10px;
        cursor: pointer;
        border-color: #010d26;
      }

      button:hover {
        background-color: #0339a6;
      }

      button:active {
        color: #000000;
        background-color: rgba(0, 255, 255, 0.75);
      }
      img.image {
        width: 100%;
        height: 100%;
        border-radius: 10px;
      }
    </style>
  </head>
  <body>
    <script src="tween.min.js"></script>

    <div id="container"></div>
    <div id="menu">
      <button id="table" style="display: none">TABLE</button>
      <button id="sphere">SPHERE</button>
      <button id="helix">HELIX</button>
      <button id="grid">GRID</button>
    </div>

    <embed
      name="GoodEnough"
      src="./musics/Noi-Nay-Co-Anh-Son-Tung-M-TP.mp3"
      loop = "2"
      hidden = "true"
      autostart = "true"
      volume = "50"
    />

    <script type="module">
      import * as THREE from "./three.module.js";

      import { TrackballControls } from "./TrackballControls.js";
      import { CSS3DRenderer, CSS3DObject } from "./CSS3DRenderer.js";

      const img1 =
        "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRfqOS362IFieaTJf1RmbY6YQZvAO0a5f58Rv8WuM_3ROsXoVbG";
      const img2 =
        "https://scontent.fsgn2-3.fna.fbcdn.net/v/t1.0-9/65249556_2201751060040954_8485490144231555072_n.jpg?_nc_cat=106&_nc_oc=AQkH2oK7cuLZQKLBJMXAAYseocRSGb5uxc1mNBNFH6meh0CC1yDwE55l5I-WD9nLCuk&_nc_ht=scontent.fsgn2-3.fna&oh=ab4392aa33277b6b1fb65db0cd5141e3&oe=5DEAE0BF";
      const img3 =
        "https://scontent.fsgn2-1.fna.fbcdn.net/v/t1.0-9/66639423_1639921836140578_936290402237939712_n.jpg?_nc_cat=105&_nc_oc=AQltOUwkzPpKWe9TD3bJb1yGDjjIAPu2JPa7584sYm5BzZ7awiZ_mEFDPSibhsg3il8&_nc_ht=scontent.fsgn2-1.fna&oh=7e74b434a8cda1862f0c999a1a18dc1a&oe=5DE0D19A";
      const img4 =
        "https://scontent.fsgn2-1.fna.fbcdn.net/v/t1.0-9/15203269_600714530112846_4619159008164388523_n.jpg?_nc_cat=111&_nc_oc=AQlhn8S7GW1vl64Zyja01d9TG925GIf_iP6YFhfnUmFahhBZUFBQMsticvH2CrQEDPI&_nc_ht=scontent.fsgn2-1.fna&oh=5c6a721851d172c2f265fe4761891b54&oe=5DE12C3F";
      const img5 =
        "https://scontent.fsgn2-4.fna.fbcdn.net/v/t1.0-1/c3.0.720.720a/59965043_1775399935938548_2034154575048474624_n.jpg?_nc_cat=109&_nc_oc=AQnF7Or-DNQUrUJhEbfDK57-AR879ncByuLY8u06yufVS4iROMthbRujNSivFMrF8R8&_nc_ht=scontent.fsgn2-4.fna&oh=b110a75255304a147619ae16c82739c9&oe=5DDF7AD2";
      const img6 =
        "https://scontent.fsgn2-3.fna.fbcdn.net/v/t1.0-9/26168079_2115959895292050_4075496355355061106_n.jpg?_nc_cat=106&_nc_oc=AQlwRZofyzpD4g2P30Fh3lw6GRCZ8JlG2dg4VU-eInJrNhWdSbNp01w-ULMOQPm8bh8&_nc_ht=scontent.fsgn2-3.fna&oh=cbf1162b122796ffa83e305065e248c3&oe=5DE66765";
      const img7 =
        "https://scontent.fsgn2-4.fna.fbcdn.net/v/t1.0-9/34962526_1670201939745666_935045514557128704_n.jpg?_nc_cat=109&_nc_oc=AQlhIU83HaivQnDiX0q_qLJDVn7Te7oHdFehHttxUfNi90gxsKBzzWHKVN2DuQm1WFQ&_nc_ht=scontent.fsgn2-4.fna&oh=634696a511718abac824e229b21aba0c&oe=5DA325B4";
      const img8 =
        "https://scontent.fsgn2-3.fna.fbcdn.net/v/t1.0-9/48413855_1935705749882377_5781451688984444928_n.jpg?_nc_cat=106&_nc_oc=AQlBowkYkeFcaAuY8YUk-njUHoi97tMDQqyeakUJnMWG4KbgzqSy1jVZS3uMKZPqvkw&_nc_ht=scontent.fsgn2-3.fna&oh=4fa0775a8c2249151e5dc062e4c8d653&oe=5DAF2103";

      var table = [
        img1,
        1,
        1,
        img2,
        18,
        1,
        img3,
        1,
        2,
        img4,
        2,
        2,
        img5,
        13,
        2,
        img6,
        14,
        2,
        img7,
        15,
        2,
        img8,
        16,
        2,
        img1,
        17,
        2,
        img2,
        18,
        2,
        img3,
        1,
        3,
        img4,
        2,
        3,
        img5,
        13,
        3,
        img6,
        14,
        3,
        img7,
        15,
        3,
        img8,
        16,
        3,
        img1,
        17,
        3,
        img2,
        18,
        3,
        img3,
        1,
        4,
        img4,
        2,
        4,
        img5,
        3,
        4,
        img6,
        4,
        4,
        img7,
        5,
        4,
        img8,
        6,
        4,
        img1,
        7,
        4,
        img2,
        8,
        4,
        img3,
        9,
        4,
        img4,
        10,
        4,
        img5,
        11,
        4,
        img6,
        12,
        4,
        img7,
        13,
        4,
        img8,
        14,
        4,
        img1,
        15,
        4,
        img2,
        16,
        4,
        img3,
        17,
        4,
        img4,
        18,
        4,
        img5,
        1,
        5,
        img6,
        2,
        5,
        img7,
        3,
        5,
        img8,
        4,
        5,
        img1,
        5,
        5,
        img2,
        6,
        5,
        img3,
        7,
        5,
        img4,
        8,
        5,
        img5,
        9,
        5,
        img6,
        10,
        5,
        img7,
        11,
        5,
        img8,
        12,
        5,
        img1,
        13,
        5,
        img2,
        14,
        5,
        img3,
        15,
        5,
        img4,
        16,
        5,
        img5,
        17,
        5,
        img6,
        18,
        5,
        img7,
        1,
        6,
        img8,
        2,
        6,
        img1,
        4,
        9,
        img2,
        5,
        9,
        img3,
        6,
        9,
        img4,
        7,
        9,
        img5,
        8,
        9,
        img6,
        9,
        9,
        img7,
        10,
        9,
        img8,
        11,
        9,
        img1,
        12,
        9,
        img2,
        13,
        9,
        img3,
        14,
        9,
        img4,
        15,
        9,
        img5,
        16,
        9,
        img6,
        17,
        9,
        img7,
        18,
        9,
        img8,
        4,
        6,
        img1,
        5,
        6,
        img2,
        6,
        6,
        img3,
        7,
        6,
        img4,
        8,
        6,
        img5,
        9,
        6,
        img6,
        10,
        6,
        img7,
        11,
        6,
        img8,
        12,
        6,
        img1,
        13,
        6,
        img2,
        14,
        6,
        img3,
        15,
        6,
        img4,
        16,
        6,
        img5,
        17,
        6,
        img6,
        18,
        6,
        img7,
        1,
        7,
        img8,
        2,
        7,
        img1,
        4,
        10,
        img2,
        5,
        10,
        img3,
        6,
        10,
        img4,
        7,
        10,
        img5,
        8,
        10,
        img6,
        9,
        10,
        img7,
        10,
        10,
        img8,
        11,
        10,
        img1,
        12,
        10,
        img2,
        13,
        10,
        img3,
        14,
        10,
        img4,
        15,
        10,
        img5,
        16,
        10,
        img6,
        17,
        10,
        img7,
        18,
        10,
        img8,
        4,
        7,
        img1,
        5,
        7,
        img2,
        6,
        7,
        img3,
        7,
        7,
        img4,
        8,
        7,
        img5,
        9,
        7,
        img6,
        10,
        7,
        img7,
        11,
        7,
        img8,
        12,
        7,
        img1,
        13,
        7,
        img2,
        14,
        7,
        img3,
        15,
        7,
        img4,
        16,
        7,
        img5,
        17,
        7,
        img6,
        18,
        7
      ];

      var camera, scene, renderer;
      var controls;

      var objects = [];
      var targets = { table: [], sphere: [], helix: [], grid: [] };

      init();
      animate();

      function init() {
        camera = new THREE.PerspectiveCamera(
          40,
          window.innerWidth / window.innerHeight,
          1,
          10000
        );
        camera.position.z = 2500;

        scene = new THREE.Scene();

        // table

        for (var i = 0; i < table.length; i += 3) {
          var element = document.createElement("div");
          element.className = "element";

          var image = document.createElement("img");
          image.src = table[i];
          image.className = "image";
          element.appendChild(image);

          var object = new CSS3DObject(element);
          object.position.x = Math.random() * 4000 - 2000;
          object.position.y = Math.random() * 4000 - 2000;
          object.position.z = Math.random() * 4000 - 2000;
          scene.add(object);

          objects.push(object);

          //

          var object = new THREE.Object3D();
          object.position.x = table[i + 1] * 140 - 1330;
          object.position.y = -(table[i + 2] * 180) + 990;

          targets.table.push(object);
        }

        // sphere

        var vector = new THREE.Vector3();

        for (var i = 0, l = objects.length; i < l; i++) {
          var phi = Math.acos(-1 + (2 * i) / l);
          var theta = Math.sqrt(l * Math.PI) * phi;

          var object = new THREE.Object3D();

          object.position.setFromSphericalCoords(800, phi, theta);

          vector.copy(object.position).multiplyScalar(2);

          object.lookAt(vector);

          targets.sphere.push(object);
        }

        // helix

        var vector = new THREE.Vector3();

        for (var i = 0, l = objects.length; i < l; i++) {
          var theta = i * 0.175 + Math.PI;
          var y = -(i * 8) + 450;

          var object = new THREE.Object3D();

          object.position.setFromCylindricalCoords(900, theta, y);

          vector.x = object.position.x * 2;
          vector.y = object.position.y;
          vector.z = object.position.z * 2;

          object.lookAt(vector);

          targets.helix.push(object);
        }

        // grid

        for (var i = 0; i < objects.length; i++) {
          var object = new THREE.Object3D();

          object.position.x = (i % 5) * 400 - 800;
          object.position.y = -(Math.floor(i / 5) % 5) * 400 + 800;
          object.position.z = Math.floor(i / 25) * 1000 - 2000;

          targets.grid.push(object);
        }

        //

        renderer = new CSS3DRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById("container").appendChild(renderer.domElement);

        //

        controls = new TrackballControls(camera, renderer.domElement);
        controls.minDistance = 500;
        controls.maxDistance = 6000;
        controls.addEventListener("change", render);

        var button = document.getElementById("table");
        button.addEventListener(
          "click",
          function() {
            transform(targets.table, 2000);
          },
          false
        );

        var button = document.getElementById("sphere");
        button.addEventListener(
          "click",
          function() {
            transform(targets.sphere, 2000);
          },
          false
        );

        var button = document.getElementById("helix");
        button.addEventListener(
          "click",
          function() {
            transform(targets.helix, 2000);
          },
          false
        );

        var button = document.getElementById("grid");
        button.addEventListener(
          "click",
          function() {
            transform(targets.grid, 2000);
          },
          false
        );

        transform(targets.sphere, 2000);

        //

        window.addEventListener("resize", onWindowResize, false);
      }

      function transform(targets, duration) {
        TWEEN.removeAll();

        for (var i = 0; i < objects.length; i++) {
          var object = objects[i];
          var target = targets[i];

          new TWEEN.Tween(object.position)
            .to(
              {
                x: target.position.x,
                y: target.position.y,
                z: target.position.z
              },
              Math.random() * duration + duration
            )
            .easing(TWEEN.Easing.Exponential.InOut)
            .start();

          new TWEEN.Tween(object.rotation)
            .to(
              {
                x: target.rotation.x,
                y: target.rotation.y,
                z: target.rotation.z
              },
              Math.random() * duration + duration
            )
            .easing(TWEEN.Easing.Exponential.InOut)
            .start();
        }

        new TWEEN.Tween(this)
          .to({}, duration * 2)
          .onUpdate(render)
          .start();
      }

      function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize(window.innerWidth, window.innerHeight);

        render();
      }

      function animate() {
        scene.rotation.y += 0.004;

        requestAnimationFrame(animate);

        TWEEN.update();

        controls.update();

        render();
      }

      function render() {
        renderer.render(scene, camera);
      }
    </script>
  </body>
</html>
